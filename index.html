<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Affiliate Link Script Maker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/html-doc-js@1.1.0/dist/html-doc.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .card { transition: all 0.3s ease-in-out; border: 1px solid rgba(255,255,255,0.1); }
    .card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); }
    .btn { display:inline-flex; align-items:center; justify-content:center; gap:0.5rem; padding:0.5rem 1rem; border-radius:0.5rem; font-weight:500; transition:all 0.2s; }
    .btn-primary { background:#4f46e5; color:white; }
    .btn-primary:hover { background:#4338ca; box-shadow:0 4px 14px rgba(79,70,229,0.39); }
    #loader { border:4px solid #4a5568; border-top:4px solid #4f46e5; border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; }
    @keyframes spin { 0% { transform:rotate(0deg);} 100% {transform:rotate(360deg);} }
    @keyframes fadeIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
    .animate-fadeIn { animation: fadeIn 1.2s ease-out forwards; }
  </style>
</head>
<body class="relative bg-slate-900 text-gray-200 overflow-hidden">

  <!-- Background Gradient -->
  <div class="absolute inset-0 bg-gradient-to-br from-slate-900 via-indigo-900/50 to-slate-800"></div>
  <div class="absolute -top-32 -left-32 w-96 h-96 bg-indigo-600/30 rounded-full blur-3xl animate-pulse"></div>
  <div class="absolute bottom-0 right-0 w-80 h-80 bg-sky-500/20 rounded-full blur-2xl animate-bounce"></div>
  <div class="absolute inset-0 bg-[linear-gradient(45deg,rgba(255,255,255,0.05)_1px,transparent_1px)] bg-[length:40px_40px] opacity-10 pointer-events-none"></div>

  <!-- HERO SECTION -->
  <section class="relative z-10 container mx-auto px-6 pt-16 pb-20">
    <div class="grid grid-cols-1 md:grid-cols-2 items-center gap-10">
      <!-- Text -->
      <div class="card bg-slate-800/50 backdrop-blur-xl border-slate-700 p-10 shadow-lg">
        <div class="flex justify-start mb-4">
          <i data-lucide="sparkles" class="w-10 h-10 text-indigo-400"></i>
        </div>
        <h1 class="text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-sky-400 to-indigo-400 bg-clip-text text-transparent drop-shadow-lg">
          Affiliate Link Script Maker
        </h1>
        <p class="mt-4 text-lg text-gray-300 animate-fadeIn">
          Generator skrip affiliasi tercepat! ðŸš€ Tempel link produk, salin skripnya, dan pasang di web atau media sosial Anda tanpa ribet.
        </p>
        <div class="mt-8">
          <a href="#generator" class="btn btn-primary px-6 py-3 text-lg hover:scale-105 transform transition">
            Mulai Generate
          </a>
        </div>
      </div>
      <!-- Mockup Image -->
      <div class="flex justify-center">
        <img src="https://placehold.co/400x300/1e293b/fff?text=Mockup+Produk" 
             alt="Mockup Produk"
             class="rounded-xl shadow-lg border border-slate-700 object-cover">
      </div>
    </div>
  </section>

  <!-- MAIN GENERATOR FORM -->
  <div id="generator" class="container relative mx-auto p-4 md:p-8 max-w-4xl z-10">
    <div class="card p-6 md:p-8 mb-8 bg-slate-800/50 backdrop-blur-xl border-slate-700">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Input Link -->
        <div class="md:col-span-2">
          <label for="productUrl" class="block text-sm font-medium text-gray-300 mb-1">Link Produk (Wajib)</label>
          <input type="url" id="productUrl" placeholder="Tempelkan link produk afiliasi Anda di sini..."
                 class="w-full p-2 border border-slate-600 rounded-md focus:ring-indigo-500 bg-slate-700">
        </div>
        <!-- Custom Desc -->
        <div class="md:col-span-2">
          <label for="customDesc" class="block text-sm font-medium text-gray-300 mb-1">Deskripsi Singkat Produk (Opsional)</label>
          <input type="text" id="customDesc" placeholder="Contoh: Sepatu running ringan dan nyaman..."
                 class="w-full p-2 border border-slate-600 rounded-md focus:ring-indigo-500 bg-slate-700">
        </div>
        <!-- Style -->
        <div>
          <label for="languageStyle" class="block text-sm font-medium text-gray-300 mb-1">Gaya Bahasa</label>
          <select id="languageStyle" class="w-full p-2 border border-slate-600 rounded-md focus:ring-indigo-500 bg-slate-700">
            <option value="Persuasif & Menjual">Persuasif & Menjual</option>
            <option value="Informatif & Edukatif">Informatif & Edukatif</option>
            <option value="Santai & Kasual">Santai & Kasual</option>
            <option value="Gen Z">Gen Z</option>
          </select>
        </div>
        <!-- Length -->
        <div>
          <label for="contentLength" class="block text-sm font-medium text-gray-300 mb-1">Panjang Tulisan</label>
          <select id="contentLength" class="w-full p-2 border border-slate-600 rounded-md focus:ring-indigo-500 bg-slate-700">
            <option value="Pendek">Pendek (~50 kata)</option>
            <option value="Sedang">Sedang (~150 kata)</option>
            <option value="Panjang">Panjang (300+ kata)</option>
          </select>
        </div>
        <!-- Variations -->
        <div class="md:col-span-2">
          <label for="generateCount" class="block text-sm font-medium text-gray-300 mb-1">Jumlah Variasi</label>
          <input type="number" id="generateCount" value="2" min="1" max="5"
                 class="w-full p-2 border border-slate-600 rounded-md focus:ring-indigo-500 bg-slate-700">
        </div>
      </div>
      <!-- Button -->
      <div class="mt-8 text-center">
        <button id="generateBtn" class="btn btn-primary w-full md:w-auto px-8 py-3 text-lg transform hover:scale-105">
          <i data-lucide="sparkles" class="w-5 h-5"></i>
          <span>Generate Script!</span>
        </button>
      </div>
    </div>
    <!-- Output -->
    <div id="outputSection" class="space-y-6"></div>
    <div id="loaderContainer" class="hidden justify-center items-center flex-col text-center">
      <div id="loader"></div>
      <p class="mt-4 text-gray-400">AI sedang meracik kata-kata... Mohon tunggu sebentar.</p>
    </div>
    <div id="error-message" class="hidden card bg-red-900/20 border-red-500/30 p-4 text-center mt-6">
      <p class="font-semibold text-red-400">Oops, terjadi kesalahan!</p>
      <p id="error-text" class="text-red-400 text-sm mt-1"></p>
    </div>
  </div>

  <script type="module">
    const { jsPDF } = window.jspdf;
    const generateBtn = document.getElementById('generateBtn');
    const outputSection = document.getElementById('outputSection');
    const loaderContainer = document.getElementById('loaderContainer');
    const errorMessage = document.getElementById('error-message');
    const errorText = document.getElementById('error-text');
    lucide.createIcons();

    function showError(msg){ errorText.textContent=msg; errorMessage.classList.remove("hidden"); }
    function hideError(){ errorMessage.classList.add("hidden"); }

    generateBtn.addEventListener('click', async () => {
      const linkProduk=document.getElementById('productUrl').value;
      const deskripsi=document.getElementById('customDesc').value;
      const gaya=document.getElementById('languageStyle').value;
      const panjang=document.getElementById('contentLength').value;
      const jumlah=document.getElementById('generateCount').value;
      if(!linkProduk) return showError("Mohon isi Link Produk.");
      hideError(); loaderContainer.classList.remove("hidden");
      try{
        const resp=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({linkProduk,deskripsi,gaya,panjang,jumlah})});
        const data=await resp.json();
        loaderContainer.classList.add("hidden"); outputSection.innerHTML="";
        if(!resp.ok) throw new Error(data.error||"Gagal");
        if(Array.isArray(data.result)){
          data.result.forEach((txt,idx)=>{
            const card=document.createElement("div");
            card.className="card p-6 bg-slate-800/60 backdrop-blur-xl border-slate-700";
            card.innerHTML=`<h3 class="text-lg font-semibold text-indigo-400 mb-2">Variasi ${idx+1}</h3><div class="text-gray-300 whitespace-pre-wrap">${txt}</div>`;
            outputSection.appendChild(card);
          });
        } else { outputSection.innerHTML=`<p class="text-gray-300">${data.result}</p>`; }
      }catch(e){ loaderContainer.classList.add("hidden"); showError(e.message); }
    });
  </script>
</body>
</html>
