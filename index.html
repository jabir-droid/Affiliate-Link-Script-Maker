<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Affiliate Link Script Maker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .bg-hero:before{
      content:"";position:absolute;inset:0;z-index:-1;
      background:
        radial-gradient(800px 300px at 10% -10%,rgba(99,102,241,.25),transparent 60%),
        radial-gradient(700px 300px at 110% 0%,rgba(56,189,248,.18),transparent 60%),
        url("/public/bg/ai-network-1.jpg") center/cover no-repeat;
      filter:saturate(1.05) contrast(1.05) brightness(.9);
    }
    .glass{background:rgba(2,6,23,.68);border:1px solid rgba(148,163,184,.18);box-shadow:0 10px 35px rgba(0,0,0,.45);backdrop-filter:blur(8px)}
    .title-grad{background:linear-gradient(90deg,#93c5fd,#c4b5fd,#60a5fa);-webkit-background-clip:text;background-clip:text;color:transparent}
    .btn-primary{background:#4f46e5}.btn-primary:hover{background:#4338ca}
  </style>
</head>
<body class="min-h-screen relative bg-slate-950 text-slate-200 bg-hero">

  <main class="relative z-10 max-w-5xl mx-auto px-6 pt-16 pb-24">
    <header class="text-center mb-8">
      <h1 class="title-grad text-4xl md:text-6xl font-extrabold">Affiliate Link Script Maker</h1>
      <p class="mt-4 text-lg md:text-xl text-slate-300/90">
        Generator skrip afiliasi tercepat! Tempel link produk, salin skripnya, dan pasang di web atau media sosial Anda tanpa ribet.
      </p>
    </header>

    <!-- Kartu login nama -->
    <section class="glass rounded-3xl p-6 md:p-8 max-w-2xl mx-auto">
      <label class="block text-sm font-medium text-slate-300 mb-2" for="nama">Nama Anda <span class="text-rose-400">*</span></label>
      <input id="nama" type="text" placeholder="Contoh: Jaadz"
        class="w-full rounded-xl bg-slate-800/60 border border-slate-600 px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500" />
      <p id="errName" class="text-rose-300 text-sm mt-2"></p>

      <button id="btnMasuk" class="btn-primary w-full mt-5 px-6 py-4 rounded-xl font-semibold">
        Masuk & Lanjutkan →
      </button>
    </section>

    <footer class="mt-12 text-center text-sm text-slate-400/80">
      © 2025 – Dilarang Menduplikasi dan Menyebarluaskan Tanpa Izin Pemilik.
    </footer>
  </main>

  <script>
    // Kalau user sudah pernah isi nama, langsung ke generator
    (function autoForward(){
      const id = localStorage.getItem('aff_user_id');
      const name = localStorage.getItem('aff_user_name');
      if (id && name) window.location.href = '/generator.html';
    })();

    // Submit nama → /api/users
    document.getElementById('btnMasuk').addEventListener('click', submitName);
    async function submitName() {
      const input = document.getElementById('nama');
      const name = (input.value || '').trim();
      const err = document.getElementById('errName');
      err.textContent = '';
      if (!name) { err.textContent = 'Nama wajib diisi.'; return; }

      const btn = document.getElementById('btnMasuk');
      btn.disabled = true;
      const original = btn.innerHTML;
      btn.innerHTML = 'Mendaftarkan…';

      try {
        const r = await fetch('/api/users', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ name })
        });
        const j = await r.json();
        if (!r.ok || !j.ok) throw new Error(j.message || 'Gagal mendaftarkan nama');

        localStorage.setItem('aff_user_id', j.id);
        localStorage.setItem('aff_user_name', j.name);
        // transisi ringan
        document.body.style.transition = 'opacity .25s ease';
        document.body.style.opacity = '0';
        setTimeout(()=>location.href='/generator.html', 200);
      } catch(e) {
        err.textContent = e.message;
      } finally {
        btn.disabled = false;
        btn.innerHTML = original;
      }
    }
  </script>
</body>
</html>
